import HeytingLean.LoF.Combinators.Category.Completion2PathBicategory

/-!
# Completion3Cell ‚Äî explicit 3-cells for completion 2-path coherence

`Completion2PathBicategory.lean` constructs a non-thin bicategory by quotienting explicit
completion 2-cells (`Completion2Path`) by a Prop-valued relation `Completion2PathRel`
generated by bicategory coherence axioms and closed under vertical composition and whiskering.

For the ‚Äúhigher cell‚Äù program we want these coherence steps as *data* rather than only as a
quotient relation.  This file reifies the generators of `Completion2PathRel` as a `Type` of
3-cells between parallel `Completion2Path`s.
-/

namespace HeytingLean
namespace LoF
namespace Combinators
namespace Category

open CategoryTheory

/-- Type-valued 3-cells witnessing coherence between parallel completion 2-paths.

This is a reification of the Prop-level relation `Completion2PathRel` used to build
`skyCompletion2PathQuotBicategory`, with additional reflexivity/symmetry/transitivity
constructors so 3-cells can be composed as explicit witness data. -/
inductive Completion3Cell :
    ‚àÄ {a b : MWObj} {p q : a ‚ü∂ b}, Completion2Path p q ‚Üí Completion2Path p q ‚Üí Type
  | refl {a b : MWObj} {p q : a ‚ü∂ b} (Œ∑ : Completion2Path p q) :
      Completion3Cell Œ∑ Œ∑
  | symm {a b : MWObj} {p q : a ‚ü∂ b} {Œ∑ Œ∑' : Completion2Path p q} :
      Completion3Cell Œ∑ Œ∑' ‚Üí Completion3Cell Œ∑' Œ∑
  | trans {a b : MWObj} {p q : a ‚ü∂ b} {Œ∑ Œ∑' Œ∑'' : Completion2Path p q} :
      Completion3Cell Œ∑ Œ∑' ‚Üí Completion3Cell Œ∑' Œ∑'' ‚Üí Completion3Cell Œ∑ Œ∑''
  | vcomp_left {a b : MWObj} {p q r : a ‚ü∂ b}
      (Œ∑‚ÇÅ Œ∑‚ÇÇ : Completion2Path p q) (Œ∏ : Completion2Path q r) :
      Completion3Cell Œ∑‚ÇÅ Œ∑‚ÇÇ ‚Üí
        Completion3Cell (Completion2Path.vcomp Œ∑‚ÇÅ Œ∏) (Completion2Path.vcomp Œ∑‚ÇÇ Œ∏)
  | vcomp_right {a b : MWObj} {p q r : a ‚ü∂ b}
      (Œ∑ : Completion2Path p q) (Œ∏‚ÇÅ Œ∏‚ÇÇ : Completion2Path q r) :
      Completion3Cell Œ∏‚ÇÅ Œ∏‚ÇÇ ‚Üí
        Completion3Cell (Completion2Path.vcomp Œ∑ Œ∏‚ÇÅ) (Completion2Path.vcomp Œ∑ Œ∏‚ÇÇ)
  | whisker_left {a b c : MWObj} (f : a ‚ü∂ b) {g h : b ‚ü∂ c}
      (Œ∑ Œ∑' : Completion2Path g h) :
      Completion3Cell Œ∑ Œ∑' ‚Üí
        Completion3Cell (Completion2Path.whiskerLeft f Œ∑) (Completion2Path.whiskerLeft f Œ∑')
  | whisker_right {a b c : MWObj} {f g : a ‚ü∂ b}
      (Œ∑ Œ∑' : Completion2Path f g) (h : b ‚ü∂ c) :
      Completion3Cell Œ∑ Œ∑' ‚Üí
        Completion3Cell (Completion2Path.whiskerRight Œ∑ h) (Completion2Path.whiskerRight Œ∑' h)
  | whisker_left_id {a b c : MWObj} (f : a ‚ü∂ b) (g : b ‚ü∂ c) :
      Completion3Cell
        (Completion2Path.whiskerLeft f (Completion2Path.id g))
        (Completion2Path.id (f ‚â´ g))
  | whisker_left_comp {a b c : MWObj} (f : a ‚ü∂ b) {g h i : b ‚ü∂ c}
      (Œ∑ : Completion2Path g h) (Œ∏ : Completion2Path h i) :
      Completion3Cell
        (Completion2Path.whiskerLeft f (Completion2Path.vcomp Œ∑ Œ∏))
        (Completion2Path.vcomp (Completion2Path.whiskerLeft f Œ∑) (Completion2Path.whiskerLeft f Œ∏))
  | id_whisker_left {a b : MWObj} {f g : a ‚ü∂ b} (Œ∑ : Completion2Path f g) :
      Completion3Cell
        (Completion2Path.whiskerLeft (ùüô a) Œ∑)
        (Completion2Path.vcomp (Completion2Path.id f)
          (Completion2Path.vcomp Œ∑ (Completion2Path.id g)))
  | comp_whisker_left {a b c d : MWObj} (f : a ‚ü∂ b) (g : b ‚ü∂ c) {h h' : c ‚ü∂ d}
      (Œ∑ : Completion2Path h h') :
      Completion3Cell
        (Completion2Path.whiskerLeft (f ‚â´ g) Œ∑)
        (Completion2Path.vcomp (Completion2Path.eqToHom (LSteps.comp_assoc f g h))
          (Completion2Path.vcomp (Completion2Path.whiskerLeft f (Completion2Path.whiskerLeft g Œ∑))
            (Completion2Path.eqToHom (LSteps.comp_assoc f g h').symm)))
  | id_whisker_right {a b c : MWObj} (f : a ‚ü∂ b) (g : b ‚ü∂ c) :
      Completion3Cell
        (Completion2Path.whiskerRight (Completion2Path.id f) g)
        (Completion2Path.id (f ‚â´ g))
  | comp_whisker_right {a b c : MWObj} {f g h : a ‚ü∂ b} (Œ∑ : Completion2Path f g)
      (Œ∏ : Completion2Path g h) (i : b ‚ü∂ c) :
      Completion3Cell
        (Completion2Path.whiskerRight (Completion2Path.vcomp Œ∑ Œ∏) i)
        (Completion2Path.vcomp (Completion2Path.whiskerRight Œ∑ i) (Completion2Path.whiskerRight Œ∏ i))
  | whisker_right_id {a b : MWObj} {f g : a ‚ü∂ b} (Œ∑ : Completion2Path f g) :
      Completion3Cell
        (Completion2Path.whiskerRight Œ∑ (ùüô b))
        (Completion2Path.vcomp (Completion2Path.eqToHom (LSteps.comp_refl_right f))
          (Completion2Path.vcomp Œ∑ (Completion2Path.eqToHom (LSteps.comp_refl_right g).symm)))
  | whisker_right_comp {a b c d : MWObj} {f f' : a ‚ü∂ b} (Œ∑ : Completion2Path f f')
      (g : b ‚ü∂ c) (h : c ‚ü∂ d) :
      Completion3Cell
        (Completion2Path.whiskerRight Œ∑ (g ‚â´ h))
        (Completion2Path.vcomp (Completion2Path.eqToHom (LSteps.comp_assoc f g h).symm)
          (Completion2Path.vcomp (Completion2Path.whiskerRight (Completion2Path.whiskerRight Œ∑ g) h)
            (Completion2Path.eqToHom (LSteps.comp_assoc f' g h))))
  | whisker_assoc {a b c d : MWObj} (f : a ‚ü∂ b) {g g' : b ‚ü∂ c} (Œ∑ : Completion2Path g g')
      (h : c ‚ü∂ d) :
      Completion3Cell
        (Completion2Path.whiskerRight (Completion2Path.whiskerLeft f Œ∑) h)
        (Completion2Path.vcomp (Completion2Path.eqToHom (LSteps.comp_assoc f g h))
          (Completion2Path.vcomp (Completion2Path.whiskerLeft f (Completion2Path.whiskerRight Œ∑ h))
            (Completion2Path.eqToHom (LSteps.comp_assoc f g' h).symm)))
  | whisker_exchange {a b c : MWObj}
      {f g : a ‚ü∂ b} {h i : b ‚ü∂ c}
      (Œ∑ : Completion2Path f g) (Œ∏ : Completion2Path h i) :
      Completion3Cell
        (Completion2Path.vcomp (Completion2Path.whiskerLeft f Œ∏) (Completion2Path.whiskerRight Œ∑ i))
        (Completion2Path.vcomp (Completion2Path.whiskerRight Œ∑ h) (Completion2Path.whiskerLeft g Œ∏))
  | pentagon {a b c d e : MWObj} (f : a ‚ü∂ b) (g : b ‚ü∂ c) (h : c ‚ü∂ d) (i : d ‚ü∂ e) :
      Completion3Cell
        (Completion2Path.vcomp
          (Completion2Path.whiskerRight (Completion2Path.eqToHom (LSteps.comp_assoc f g h)) i)
          (Completion2Path.vcomp (Completion2Path.eqToHom (LSteps.comp_assoc f (g ‚â´ h) i))
            (Completion2Path.whiskerLeft f (Completion2Path.eqToHom (LSteps.comp_assoc g h i)))))
        (Completion2Path.vcomp (Completion2Path.eqToHom (LSteps.comp_assoc (f ‚â´ g) h i))
          (Completion2Path.eqToHom (LSteps.comp_assoc f g (h ‚â´ i))))
  | triangle {a b c : MWObj} (f : a ‚ü∂ b) (g : b ‚ü∂ c) :
      Completion3Cell
        (Completion2Path.vcomp (Completion2Path.eqToHom (LSteps.comp_assoc f (ùüô b) g))
          (Completion2Path.whiskerLeft f (Completion2Path.id g)))
        (Completion2Path.whiskerRight (Completion2Path.eqToHom (LSteps.comp_refl_right f)) g)

namespace Completion3Cell

/-- Reify a Prop-level coherence step into **existence** of an explicit 3-cell witness.

Because `Completion2PathRel` lives in `Prop` and has multiple constructors, Lean‚Äôs elimination
restriction prevents a definitional function `Completion2PathRel ‚Üí Completion3Cell`.
This lemma is the strongest constructively available form (`Nonempty`). -/
theorem nonempty_ofRel {a b : MWObj} {p q : a ‚ü∂ b} {Œ∑ Œ∑' : Completion2Path p q} :
    Completion2PathRel (a := a) (b := b) (p := p) (q := q) Œ∑ Œ∑' ‚Üí Nonempty (Completion3Cell Œ∑ Œ∑') := by
  intro h
  induction h with
  | vcomp_left Œ∑‚ÇÅ Œ∑‚ÇÇ Œ∏ hRel ih =>
      rcases ih with ‚ü®cell‚ü©
      exact ‚ü®Completion3Cell.vcomp_left (Œ∑‚ÇÅ := Œ∑‚ÇÅ) (Œ∑‚ÇÇ := Œ∑‚ÇÇ) (Œ∏ := Œ∏) cell‚ü©
  | vcomp_right Œ∑ Œ∏‚ÇÅ Œ∏‚ÇÇ hRel ih =>
      rcases ih with ‚ü®cell‚ü©
      exact ‚ü®Completion3Cell.vcomp_right (Œ∑ := Œ∑) (Œ∏‚ÇÅ := Œ∏‚ÇÅ) (Œ∏‚ÇÇ := Œ∏‚ÇÇ) cell‚ü©
  | whisker_left f Œ∑‚ÇÅ Œ∑‚ÇÇ hRel ih =>
      rcases ih with ‚ü®cell‚ü©
      exact ‚ü®Completion3Cell.whisker_left (f := f) (Œ∑ := Œ∑‚ÇÅ) (Œ∑' := Œ∑‚ÇÇ) cell‚ü©
  | whisker_right Œ∑‚ÇÅ Œ∑‚ÇÇ h hRel ih =>
      rcases ih with ‚ü®cell‚ü©
      exact ‚ü®Completion3Cell.whisker_right (Œ∑ := Œ∑‚ÇÅ) (Œ∑' := Œ∑‚ÇÇ) (h := h) cell‚ü©
  | whisker_left_id f g =>
      exact ‚ü®Completion3Cell.whisker_left_id (f := f) (g := g)‚ü©
  | whisker_left_comp f Œ∑ Œ∏ =>
      exact ‚ü®Completion3Cell.whisker_left_comp (f := f) (Œ∑ := Œ∑) (Œ∏ := Œ∏)‚ü©
  | id_whisker_left Œ∑ =>
      exact ‚ü®Completion3Cell.id_whisker_left (Œ∑ := Œ∑)‚ü©
  | comp_whisker_left f g Œ∑ =>
      exact ‚ü®Completion3Cell.comp_whisker_left (f := f) (g := g) (Œ∑ := Œ∑)‚ü©
  | id_whisker_right f g =>
      exact ‚ü®Completion3Cell.id_whisker_right (f := f) (g := g)‚ü©
  | comp_whisker_right Œ∑ Œ∏ i =>
      exact ‚ü®Completion3Cell.comp_whisker_right (Œ∑ := Œ∑) (Œ∏ := Œ∏) (i := i)‚ü©
  | whisker_right_id Œ∑ =>
      exact ‚ü®Completion3Cell.whisker_right_id (Œ∑ := Œ∑)‚ü©
  | whisker_right_comp Œ∑ g h =>
      exact ‚ü®Completion3Cell.whisker_right_comp (Œ∑ := Œ∑) (g := g) (h := h)‚ü©
  | whisker_assoc f Œ∑ h =>
      exact ‚ü®Completion3Cell.whisker_assoc (f := f) (Œ∑ := Œ∑) (h := h)‚ü©
  | whisker_exchange Œ∑ Œ∏ =>
      exact ‚ü®Completion3Cell.whisker_exchange (Œ∑ := Œ∑) (Œ∏ := Œ∏)‚ü©
  | pentagon f g h i =>
      exact ‚ü®Completion3Cell.pentagon (f := f) (g := g) (h := h) (i := i)‚ü©
  | triangle f g =>
      exact ‚ü®Completion3Cell.triangle (f := f) (g := g)‚ü©

end Completion3Cell

end Category
end Combinators
end LoF
end HeytingLean
